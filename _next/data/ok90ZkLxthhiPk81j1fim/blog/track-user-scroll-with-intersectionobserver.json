{"pageProps":{"post":{"slug":"track-user-scroll-with-intersectionobserver","content":"<h4>A tutorial on firing a callback function when an element enters the viewport</h4>\n<p><img src=\"/jon-portella-blog/content/blog/track-user-scroll-with-intersectionobserver/images/0.png\" alt=\"\"></p>\n<h4>The problem</h4>\n<p>Our website has a new and shiny landing page. We are getting lots of visits, so the marketing team has asked us to track how many of those visitors scroll down to the Call To Action section.</p>\n<p>How can we do that?</p>\n<h4>A solution</h4>\n<p>Use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver\">window.IntersectionObserver</a> to:</p>\n<ol>\n<li>Detect when the section enters the viewport.</li>\n<li>Fire a callback that will log that event on our analytics software e.g. <a href=\"https://usefathom.com/\">Fathom</a>, <a href=\"https://matomo.org/\">Matomo</a>, <a href=\"https://analytics.google.com/\">Google Analytics</a>.</li>\n<li>Disconnect the observer to avoid logging the event more than once.</li>\n</ol>\n<p>Here’s a demo:</p>\n<p>Demonstration of window.IntersectionObserver to log user scroll to a certain section.</p>\n<hr>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Feature detection, avoid breaking IE11</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">IntersectionObserver</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.call-to-action'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">node</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Create the observer and pass the callback</span>\n        <span class=\"token keyword\">const</span> observer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IntersectionObserver</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">entries</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">isIntersecting</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// entries[0] is the element that entered into view</span>\n            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>\n              entries<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">target</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">textContent</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n              <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> scrolled into view!</span><span class=\"token template-punctuation string\">`</span></span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// Disconnect to avoid logging more than once</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// Make the observer watch for the node entering on viewport</span>\n        observer<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">observe</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n</code></pre></div>\n","frontmatter":{"title":"Track User Scroll with IntersectionObserver","spoiler":"Learn how to leverage window.IntersectionObserver to find out how many visitors see your content, in one minute.","date":"2021-03-10T13:32:36.932Z"}},"previous":{"slug":"using-regex-negative-lookahead-to-replace-http-with-https","frontmatter":{"title":"Using Regex Negative Lookahead to Replace HTTP with HTTPS","spoiler":"Learn how to use Regex’s Negative Lookahead, in one minute.","date":"2021-03-09T13:51:16.857Z"}},"next":{"slug":"count-total-lines-in-a-git-repository","frontmatter":{"title":"Count Total Lines in a Git Repository","spoiler":"Learn how to count the total number of lines in a Git repository, in one minute.","date":"2021-03-11T13:43:08.802Z"}}},"__N_SSG":true}